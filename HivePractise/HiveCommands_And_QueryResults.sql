create external table w1 (data1 string, year int, data2 string, temperature int, quality tinyint, data3 string)
row format delimited fields terminated by ','
location 'hdfs://babar.es.its.nyu.edu:8020/user/lc3397/hiveInput/';

describe w1;
/*
+--------------+------------+----------+--+
|   col_name   | data_type  | comment  |
+--------------+------------+----------+--+
| data1        | string     |          |
| year         | int        |          |
| data2        | string     |          |
| temperature  | int        |          |
| quality      | tinyint    |          |
| data3        | string     |          |
+--------------+------------+----------+--+
*/

 select * from w1 where year >= 1949;
/*
+------------------+----------+----------------------------------------------------+-----------------+-------------+---------------+--+
|     w1.data1     | w1.year  |                      w1.data2                      | w1.temperature  | w1.quality  |   w1.data3    |
+------------------+----------+----------------------------------------------------+-----------------+-------------+---------------+--+
| 006701199099999  | 1950     | 051507004888888888888888888888888888888888888888888888888889999999N9 | 0               | 1           | +99999999999  |
| 004301199099999  | 1950     | 051512004888888888888888888888888888888888888888888888888889999999N9 | 22              | 1           | +99999999999  |
| 004301199099999  | 1950     | 051518004888888888888888888888888888888888888888888888888889999999N9 | -11             | 1           | +99999999999  |
| 004301265099999  | 1949     | 032412004888888888888888888888888888888888888888888888888880500001N9 | 111             | 1           | +99999999999  |
| 004301265099999  | 1949     | 032418004888888888888888888888888888888888888888888888888880500001N9 | 78              | 1           | +99999999999  |
+------------------+----------+----------------------------------------------------+-----------------+-------------+---------------+--+
*/

select w.year, w.temp from
 (select year, max(temperature) as temp from w1 group by year) w; 
/*
+---------+---------+--+
| w.year  | w.temp  |
+---------+---------+--+
| 1949    | 111     |
| 1950    | 22      |
+---------+---------+--+
*/

dfs -ls hiveInput; 
/*
Found 3 items
-rw-------   3 lc3397 users        555 2017-04-21 21:19 hiveInput/smallWeather1.txt
-rw-------   3 lc3397 users        555 2017-04-21 22:19 hiveInput/smallWeather2.txt
-rw-------   3 lc3397 users        555 2017-04-21 22:19 hiveInput/smallWeather3.txt
*/




